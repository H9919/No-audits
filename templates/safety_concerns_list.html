<!-- templates/safety_concerns_list.html - Enhanced with Dynamic Table -->
{% extends "base.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h3><i class="bi bi-shield-exclamation text-warning"></i> Safety Concerns</h3>
    <div>
        <a href="{{ url_for('safety_concerns.new_concern') }}" class="btn btn-primary">
            <i class="bi bi-plus-circle"></i> New Safety Concern
        </a>
        <a href="{{ url_for('safety_concerns.new_concern', anonymous='true') }}" class="btn btn-outline-secondary">
            <i class="bi bi-incognito"></i> Anonymous Report
        </a>
        <div class="btn-group ms-2" role="group">
            <button class="btn btn-outline-secondary dropdown-toggle" data-bs-toggle="dropdown">
                <i class="bi bi-gear"></i> More
            </button>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="#" onclick="showBulkActions()">
                    <i class="bi bi-check2-square"></i> Bulk Actions
                </a></li>
                <li><a class="dropdown-item" href="#" onclick="showAnalytics()">
                    <i class="bi bi-graph-up"></i> Analytics
                </a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item" href="#" onclick="exportAll()">
                    <i class="bi bi-download"></i> Export All
                </a></li>
            </ul>
        </div>
    </div>
</div>

<!-- Enhanced Stats Dashboard -->
<div class="row mb-4">
    <div class="col-md-3">
        <div class="card bg-primary text-white">
            <div class="card-body text-center">
                <h4 id="totalConcerns">{{ stats.total }}</h4>
                <small>Total Concerns</small>
                <div class="progress mt-2" style="height: 4px;">
                    <div class="progress-bar bg-light" style="width: 100%"></div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card bg-warning text-white">
            <div class="card-body text-center">
                <h4 id="openConcerns">{{ stats.open }}</h4>
                <small>Open</small>
                <div class="progress mt-2" style="height: 4px;">
                    <div class="progress-bar bg-light" style="width: {{ ((stats.open / stats.total) * 100) if stats.total > 0 else 0 }}%"></div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card bg-success text-white">
            <div class="card-body text-center">
                <h4 id="resolvedConcerns">{{ stats.resolved }}</h4>
                <small>Resolved</small>
                <div class="progress mt-2" style="height: 4px;">
                    <div class="progress-bar bg-light" style="width: {{ ((stats.resolved / stats.total) * 100) if stats.total > 0 else 0 }}%"></div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card bg-info text-white">
            <div class="card-body text-center">
                <h4 id="thisMonthConcerns">{{ stats.this_month }}</h4>
                <small>This Month</small>
                <div class="progress mt-2" style="height: 4px;">
                    <div class="progress-bar bg-light" style="width: {{ ((stats.this_month / stats.total) * 100) if stats.total > 0 else 0 }}%"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Advanced Filters Section -->
<div class="card mb-4" id="advancedFilters" style="display: none;">
    <div class="card-header">
        <h6 class="mb-0"><i class="bi bi-funnel"></i> Advanced Filters</h6>
    </div>
    <div class="card-body">
        <div class="row g-3">
            <div class="col-md-3">
                <label class="form-label">Hazard Type</label>
                <select class="form-select" id="hazardTypeFilter">
                    <option value="">All Hazard Types</option>
                    <option value="slip_trip_fall">Slip/Trip/Fall</option>
                    <option value="chemical">Chemical Exposure</option>
                    <option value="equipment">Equipment/Machinery</option>
                    <option value="ergonomic">Ergonomic</option>
                    <option value="electrical">Electrical</option>
                    <option value="fire">Fire/Explosion</option>
                    <option value="environmental">Environmental</option>
                    <option value="security">Security</option>
                    <option value="other">Other</option>
                </select>
            </div>
            <div class="col-md-3">
                <label class="form-label">Date Range</label>
                <div class="input-group">
                    <input type="date" class="form-control" id="dateFrom">
                    <input type="date" class="form-control" id="dateTo">
                </div>
            </div>
            <div class="col-md-3">
                <label class="form-label">Reporter Type</label>
                <select class="form-select" id="reporterFilter">
                    <option value="">All Reports</option>
                    <option value="identified">Identified Reporter</option>
                    <option value="anonymous">Anonymous</option>
                </select>
            </div>
            <div class="col-md-3">
                <label class="form-label">Location</label>
                <input type="text" class="form-control" id="locationFilter" placeholder="Filter by location...">
            </div>
        </div>
    </div>
</div>

<!-- Main Safety Concerns Table -->
<div id="safetyConcernsTableContainer">
    <!-- Dynamic table will be rendered here -->
</div>

<!-- Include the dynamic table component -->
{% set table_id = 'safety_concerns' %}
{% set table_title = 'Safety Concerns Management' %}
{% include 'components/dynamic_table.html' %}

<!-- Bulk Actions Modal -->
<div class="modal fade" id="bulkActionsModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Bulk Actions</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label class="form-label">Select Action</label>
                    <select class="form-select" id="bulkActionSelect">
                        <option value="">Choose action...</option>
                        <option value="export">Export Selected</option>
                        <option value="assign">Assign Investigator</option>
                        <option value="status">Change Status</option>
                        <option value="priority">Set Priority</option>
                        <option value="resolve">Mark as Resolved</option>
                    </select>
                </div>
                <div id="bulkActionOptions" class="d-none">
                    <!-- Options will be populated based on selected action -->
                </div>
                <div class="alert alert-info">
                    <span id="selectedConcernsCount">0</span> safety concerns selected
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="executeBulkAction()">Apply</button>
            </div>
        </div>
    </div>
</div>

<!-- Analytics Modal -->
<div class="modal fade" id="analyticsModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Safety Concerns Analytics</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6">
                        <canvas id="concernTypeChart"></canvas>
                    </div>
                    <div class="col-md-6">
                        <canvas id="hazardTypeChart"></canvas>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-md-6">
                        <canvas id="statusChart"></canvas>
                    </div>
                    <div class="col-md-6">
                        <canvas id="trendsChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Quick Update Modal -->
<div class="modal fade" id="quickUpdateModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Quick Update Safety Concern</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <form id="quickUpdateForm">
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">New Status</label>
                        <select class="form-select" name="status" id="quickStatus">
                            <option value="reported">Reported</option>
                            <option value="investigating">Investigating</option>
                            <option value="resolved">Resolved</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Assigned To</label>
                        <input type="text" class="form-control" name="assigned_to" placeholder="Assign to...">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Priority</label>
                        <select class="form-select" name="priority">
                            <option value="low">Low</option>
                            <option value="medium">Medium</option>
                            <option value="high">High</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Comment</label>
                        <textarea class="form-control" name="comment" rows="3" placeholder="Add a comment about this update"></textarea>
                    </div>
                    <input type="hidden" name="concern_id" id="quickConcernId">
                    <input type="hidden" name="updated_by" value="Current User">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Update Concern</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Safety Concerns data from server
    const safetyConcernsData = {{ concerns|tojson }};
    
    // Enhanced column configuration with custom formatting
    const safetyConcernsColumns = [
        {
            key: 'id',
            label: 'Concern ID',
            type: 'custom',
            filterable: true,
            sortable: true,
            format: (value) => `<code>${value.substring(0, 8)}</code>`
        },
        {
            key: 'title',
            label: 'Title',
            type: 'custom',
            filterable: true,
            sortable: true,
            format: (value, row) => {
                const truncated = value.length > 50 ? value.substring(0, 50) + '...' : value;
                return `
                    <div>
                        <strong>${truncated}</strong>
                        ${row.description ? `<br><small class="text-muted">${row.description.substring(0, 80)}${row.description.length > 80 ? '...' : ''}</small>` : ''}
                    </div>
                `;
            }
        },
        {
            key: 'type',
            label: 'Type',
            type: 'badge',
            filterable: true,
            sortable: true,
            badgeMap: {
                'concern': 'info',
                'recognition': 'success'
            }
        },
        {
            key: 'location',
            label: 'Location',
            type: 'text',
            filterable: true,
            sortable: true,
            format: (value) => value || '<span class="text-muted">Not specified</span>'
        },
        {
            key: 'hazard_type',
            label: 'Hazard Type',
            type: 'custom',
            filterable: true,
            sortable: true,
            format: (value) => {
                if (!value || value === 'other') return '<span class="text-muted">General</span>';
                const formatted = value.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
                const iconMap = {
                    'Slip Trip Fall': 'person-walking',
                    'Chemical': 'droplet',
                    'Equipment': 'gear',
                    'Ergonomic': 'person-arms-up',
                    'Electrical': 'lightning',
                    'Fire': 'fire',
                    'Environmental': 'tree',
                    'Security': 'shield-lock'
                };
                const icon = iconMap[formatted] || 'exclamation-triangle';
                return `<i class="bi bi-${icon} me-1"></i>${formatted}`;
            }
        },
        {
            key: 'priority',
            label: 'Priority',
            type: 'badge',
            filterable: true,
            sortable: true,
            badgeMap: {
                'critical': 'danger',
                'high': 'warning',
                'medium': 'info',
                'low': 'secondary'
            }
        },
        {
            key: 'status',
            label: 'Status',
            type: 'badge',
            filterable: true,
            sortable: true,
            badgeMap: {
                'resolved': 'success',
                'investigating': 'warning',
                'reported': 'secondary'
            }
        },
        {
            key: 'anonymous',
            label: 'Reporter',
            type: 'custom',
            filterable: true,
            sortable: false,
            format: (value, row) => {
                if (row.anonymous) {
                    return '<span class="text-muted"><i class="bi bi-incognito"></i> Anonymous</span>';
                } else {
                    return `<span class="text-success"><i class="bi bi-person"></i> ${row.reporter || 'Identified'}</span>`;
                }
            }
        },
        {
            key: 'created_date',
            label: 'Reported Date',
            type: 'custom',
            filterable: true,
            sortable: true,
            format: (value) => {
                const date = new Date(typeof value === 'number' ? value * 1000 : value);
                const now = new Date();
                const diffDays = Math.floor((now - date) / (1000 * 60 * 60 * 24));
                
                let badge = '';
                if (diffDays <= 1) {
                    badge = ' <span class="badge bg-info">New</span>';
                } else if (diffDays <= 7) {
                    badge = ' <span class="badge bg-primary">Recent</span>';
                } else if (diffDays > 30) {
                    badge = ' <span class="badge bg-secondary">Old</span>';
                }
                
                return date.toLocaleDateString() + badge;
            }
        },
        {
            key: 'assigned_to',
            label: 'Assigned To',
            type: 'custom',
            filterable: true,
            sortable: true,
            format: (value) => value || '<span class="text-muted">Unassigned</span>'
        },
        {
            key: 'actions',
            label: 'Actions',
            type: 'custom',
            filterable: false,
            sortable: false,
            format: (value, row) => `
                <div class="btn-group btn-group-sm">
                    <a href="/safety-concerns/${row.id}" class="btn btn-outline-primary" title="View Details">
                        <i class="bi bi-eye"></i>
                    </a>
                    ${row.status !== 'resolved' ? `
                        <button class="btn btn-outline-success" onclick="quickUpdate('${row.id}', 'investigating')" title="Start Investigation">
                            <i class="bi bi-search"></i>
                        </button>
                        <button class="btn btn-outline-warning" onclick="quickUpdate('${row.id}', 'resolved')" title="Mark Resolved">
                            <i class="bi bi-check"></i>
                        </button>
                    ` : ''}
                    <div class="btn-group">
                        <button class="btn btn-outline-secondary dropdown-toggle" data-bs-toggle="dropdown">
                            <i class="bi bi-three-dots"></i>
                        </button>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="/capa/new?source=safety_concern&source_id=${row.id}">
                                <i class="bi bi-arrow-repeat"></i> Create CAPA
                            </a></li>
                            <li><a class="dropdown-item" href="#" onclick="assignInvestigator('${row.id}')">
                                <i class="bi bi-person-gear"></i> Assign Investigator
                            </a></li>
                            <li><a class="dropdown-item" href="#" onclick="escalateConcern('${row.id}')">
                                <i class="bi bi-exclamation-triangle"></i> Escalate
                            </a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#" onclick="duplicateConcern('${row.id}')">
                                <i class="bi bi-copy"></i> Duplicate
                            </a></li>
                            <li><a class="dropdown-item text-warning" href="#" onclick="archiveConcern('${row.id}')">
                                <i class="bi bi-archive"></i> Archive
                            </a></li>
                        </ul>
                    </div>
                </div>
            `
        }
    ];
    
    // Initialize the dynamic table
    const table = initTable('safety_concerns', safetyConcernsData, safetyConcernsColumns, {
        sortable: true,
        filterable: true,
        paginated: true,
        exportable: true,
        persistPreferences: true,
        selectable: true,
        defaultSort: { column: 'created_date', direction: 'desc' }
    });
    
    // Setup advanced filters
    setupAdvancedFilters();
    
    // Setup auto-refresh for real-time updates
    setInterval(loadConcernStats, 300000); // Refresh every 5 minutes
    
    // Load initial stats
    loadConcernStats();
});

function setupAdvancedFilters() {
    // Add event listeners for advanced filters
    ['hazardTypeFilter', 'dateFrom', 'dateTo', 'reporterFilter', 'locationFilter'].forEach(id => {
        const element = document.getElementById(id);
        if (element) {
            element.addEventListener('change', applyAdvancedFilters);
            if (element.type === 'text') {
                element.addEventListener('input', debounce(applyAdvancedFilters, 300));
            }
        }
    });
}

function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

function applyAdvancedFilters() {
    const table = tableInstances['safety_concerns'];
    if (!table) return;
    
    const hazardType = document.getElementById('hazardTypeFilter').value;
    const dateFrom = document.getElementById('dateFrom').value;
    const dateTo = document.getElementById('dateTo').value;
    const reporterType = document.getElementById('reporterFilter').value;
    const location = document.getElementById('locationFilter').value.toLowerCase();
    
    let filteredData = [...table.data];
    
    // Apply hazard type filter
    if (hazardType) {
        filteredData = filteredData.filter(item => item.hazard_type === hazardType);
    }
    
    // Apply reporter type filter
    if (reporterType) {
        if (reporterType === 'anonymous') {
            filteredData = filteredData.filter(item => item.anonymous === true);
        } else if (reporterType === 'identified') {
            filteredData = filteredData.filter(item => item.anonymous !== true);
        }
    }
    
    // Apply location filter
    if (location) {
        filteredData = filteredData.filter(item => 
            (item.location || '').toLowerCase().includes(location)
        );
    }
    
    // Apply date range filter
    if (dateFrom || dateTo) {
        filteredData = filteredData.filter(item => {
            if (!item.created_date) return false;
            const itemDate = new Date(typeof item.created_date === 'number' ? item.created_date * 1000 : item.created_date);
            const fromDate = dateFrom ? new Date(dateFrom) : new Date('1900-01-01');
            const toDate = dateTo ? new Date(dateTo) : new Date('2100-01-01');
            return itemDate >= fromDate && itemDate <= toDate;
        });
    }
    
    table.filteredData = filteredData;
    table.currentPage = 1;
    table.render();
    updateFilteredStats(filteredData);
}

function updateFilteredStats(filteredData) {
    document.getElementById('totalConcerns').textContent = filteredData.length;
    document.getElementById('openConcerns').textContent = 
        filteredData.filter(item => ['reported', 'investigating'].includes(item.status)).length;
    document.getElementById('resolvedConcerns').textContent = 
        filteredData.filter(item => item.status === 'resolved').length;
    
    const thirtyDaysAgo = new Date();
    thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
    document.getElementById('thisMonthConcerns').textContent = 
        filteredData.filter(item => {
            const itemDate = new Date(typeof item.created_date === 'number' ? item.created_date * 1000 : item.created_date);
            return itemDate >= thirtyDaysAgo;
        }).length;
}

function loadConcernStats() {
    fetch('/api/safety-concerns/stats')
        .then(response => response.json())
        .then(data => {
            if (data.total !== undefined) {
                document.getElementById('totalConcerns').textContent = data.total;
            }
            if (data.open !== undefined) {
                document.getElementById('openConcerns').textContent = data.open;
            }
            if (data.resolved !== undefined) {
                document.getElementById('resolvedConcerns').textContent = data.resolved;
            }
            if (data.this_month !== undefined) {
                document.getElementById('thisMonthConcerns').textContent = data.this_month;
            }
        })
        .catch(error => {
            console.error('Error loading concern stats:', error);
        });
}

function toggleAdvancedFilters() {
    const panel = document.getElementById('advancedFilters');
    panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
}

// Quick Actions
function quickUpdate(concernId, status) {
    document.getElementById('quickConcernId').value = concernId;
    document.getElementById('quickStatus').value = status;
    
    const modal = new bootstrap.Modal(document.getElementById('quickUpdateModal'));
    modal.show();
}

function assignInvestigator(concernId) {
    const investigator = prompt('Enter investigator name:');
    if (investigator) {
        updateConcern(concernId, {
            assigned_to: investigator,
            status: 'investigating',
            comment: `Assigned to ${investigator} for investigation`,
            updated_by: 'Current User'
        });
    }
}

function escalateConcern(concernId) {
    if (confirm('Escalate this safety concern to management?')) {
        updateConcern(concernId, {
            priority: 'high',
            comment: 'Safety concern escalated to management',
            updated_by: 'Current User'
        });
    }
}

function duplicateConcern(concernId) {
    if (confirm('Create a duplicate of this safety concern?')) {
        console.log('Duplicating safety concern:', concernId);
        // Implementation for duplicating concern
    }
}

function archiveConcern(concernId) {
    if (confirm('Archive this safety concern? This action can be undone.')) {
        console.log('Archiving safety concern:', concernId);
        // Implementation for archiving concern
    }
}

function updateConcern(concernId, data) {
    const formData = new FormData();
    Object.keys(data).forEach(key => {
        formData.append(key, data[key]);
    });
    
    fetch(`/safety-concerns/${concernId}/update`, {
        method: 'POST',
        body: formData
    })
    .then(response => {
        if (response.ok) {
            location.reload();
        } else {
            alert('Error updating safety concern');
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('Error updating safety concern');
    });
}

// Handle quick update form submission
document.getElementById('quickUpdateForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const formData = new FormData(this);
    const concernId = formData.get('concern_id');
    
    updateConcern(concernId, Object.fromEntries(formData));
});

// Bulk Actions
function showBulkActions() {
    const modal = new bootstrap.Modal(document.getElementById('bulkActionsModal'));
    modal.show();
}

function executeBulkAction() {
    const action = document.getElementById('bulkActionSelect').value;
    const selectedIds = getSelectedConcernIds();
    
    if (!action || selectedIds.length === 0) {
        alert('Please select an action and at least one safety concern.');
        return;
    }
    
    console.log('Executing bulk action:', action, 'on concerns:', selectedIds);
    
    // Close modal and refresh table
    bootstrap.Modal.getInstance(document.getElementById('bulkActionsModal')).hide();
}

function getSelectedConcernIds() {
    // Implementation for getting selected rows
    return [];
}

// Analytics
function showAnalytics() {
    const modal = new bootstrap.Modal(document.getElementById('analyticsModal'));
    modal.show();
    
    // Generate charts after modal is shown
    setTimeout(() => {
        generateAnalyticsCharts();
    }, 300);
}

function generateAnalyticsCharts() {
    const data = tableInstances['safety_concerns'].data;
    
    // Concern Type Chart
    const typeCtx = document.getElementById('concernTypeChart').getContext('2d');
    const typeCounts = {};
    data.forEach(concern => {
        typeCounts[concern.type] = (typeCounts[concern.type] || 0) + 1;
    });
    
    new Chart(typeCtx, {
        type: 'doughnut',
        data: {
            labels: Object.keys(typeCounts),
            datasets: [{
                data: Object.values(typeCounts),
                backgroundColor: ['#0dcaf0', '#198754']
            }]
        },
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,
                    text: 'Safety Concerns by Type'
                }
            }
        }
    });
    
    // Hazard Type Chart
    const hazardCtx = document.getElementById('hazardTypeChart').getContext('2d');
    const hazardCounts = {};
    data.forEach(concern => {
        const hazard = concern.hazard_type || 'other';
        hazardCounts[hazard] = (hazardCounts[hazard] || 0) + 1;
    });
    
    new Chart(hazardCtx, {
        type: 'bar',
        data: {
            labels: Object.keys(hazardCounts).map(h => h.replace(/_/g, ' ')),
            datasets: [{
                label: 'Number of Concerns',
                data: Object.values(hazardCounts),
                backgroundColor: '#ffc107'
            }]
        },
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,
                    text: 'Safety Concerns by Hazard Type'
                }
            }
        }
    });
}

function exportAll() {
    tableInstances['safety_concerns']?.export();
}

// Global functions for table interactions
window.quickUpdate = quickUpdate;
window.assignInvestigator = assignInvestigator;
window.escalateConcern = escalateConcern;
window.duplicateConcern = duplicateConcern;
window.archiveConcern = archiveConcern;
window.toggleAdvancedFilters = toggleAdvancedFilters;
</script>

<style>
.card h4 {
    font-size: 1.5rem;
    font-weight: 600;
}

.card small {
    font-size: 0.875rem;
    opacity: 0.9;
}

.progress {
    background-color: rgba(255, 255, 255, 0.3) !important;
}

.progress-bar {
    background-color: rgba(255, 255, 255, 0.8) !important;
}

.badge {
    font-size: 0.75rem;
}

.btn-group-sm .btn {
    padding: 0.25rem 0.5rem;
    font-size: 0.875rem;
}

.table-hover tbody tr:hover {
    background-color: rgba(0, 0, 0, 0.025);
}

.dropdown-menu {
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
    border: 1px solid rgba(0, 0, 0, 0.05);
}

.table-row-highlight {
    background-color: rgba(255, 193, 7, 0.1) !important;
}

@media (max-width: 768px) {
    .btn-group {
        flex-direction: column;
        width: 100%;
    }
    
    .btn-group .btn {
        border-radius: 0.375rem !important;
        margin-bottom: 0.25rem;
    }
    
    .card h4 {
        font-size: 1.25rem;
    }
}
</style>
{% endblock %}
